<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-elements/core-elements.html">
<link rel="import" href="../bower_components/paper-elements/paper-elements.html">

<link rel="import" href="dummy-vm-detail.html">
<link rel="import" href="aws-vm-detail.html">
<link rel="import" href="../error-display/error-display.html">

<polymer-element name="vm-detail" attributes="vmid"
  on-ajax-start="{{onAjaxStart}}" on-ajax-end="{{onAjaxEnd}}">
  <template>
    Hello VM id {{vmid}}.
    <br>
    <paper-button on-click="{{reload}}" raised disabled?="{{ajaxInProgress}}">
      <core-icon icon="refresh"></core-icon>
      Refresh
    </paper-button>
    <br>

    <template if="{{loading}}">
      Loading…
    </template>

    <template if="{{!loading}}">
      <template if="{{loadingSucceeded}}">
        <template bind ref="vm"></template>
      </template>
    </template>

    <template if="{{!ajaxInProgress && !ajaxSuccess}}">
      <br>
      <error-display text={{ajaxErrTxt}}></error-display>
    </template>

    <template id="vm">
      <template if="{{provider.type == 'dummy'}}">
        <dummy-vm-detail vmid="{{vmid}}" ajaxInProgress="{{ajaxInProgress}}">
        </dummy-vm-detail>
      </template>

      <template if="{{provider.type == 'aws'}}">
        <aws-vm-detail vmid="{{vmid}}"></aws-vm-detail>
      </template>

      <template if="{{provider.type != 'dummy' && provider.type != 'aws'}}">
        <error-display
          text="{{'Unknown vm provider type: “' + provider.type + '”'}}">
        </error-display>
      </template>

      <br>

      <button disabled?="{{ajaxInProgress}}" on-click="{{powerOn}}">
        Turn ON
      </button>
      <button disabled?="{{ajaxInProgress}}" on-click="{{powerOff}}">
        Turn OFF
      </button>
      <button disabled?="{{ajaxInProgress}}" on-click="{{reboot}}">
        Reboot
      </button>
      <button disabled?="{{ajaxInProgress}}" on-click="{{destroy}}">
        Destroy
      </button>

      <br>

      <audit-display vmid="{{vmid}}"></audit-display>
    </template>
  </template>

  <script src="vm-detail.js"></script>
</polymer-element>
